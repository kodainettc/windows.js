<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HTML5 Excel Benzeri Tablo</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: 'Segoe UI', Arial, sans-serif;
            background: #f5f5f5;
            padding: 20px;
        }
        
        .spreadsheet-container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        .toolbar {
            background: #1e3a8a;
            color: white;
            padding: 15px;
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        
        .toolbar button {
            background: #3b82f6;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            transition: background 0.3s;
        }
        
        .toolbar button:hover {
            background: #2563eb;
        }
        
        .formula-bar {
            background: #f8fafc;
            padding: 10px 15px;
            border-bottom: 1px solid #e2e8f0;
            display: flex;
            align-items: center;
        }
        
        .formula-bar label {
            font-weight: bold;
            margin-right: 10px;
            color: #475569;
        }
        
        .formula-bar input {
            flex: 1;
            padding: 8px;
            border: 1px solid #cbd5e1;
            border-radius: 4px;
            font-family: 'Consolas', monospace;
        }
        
        .spreadsheet {
            overflow: auto;
            max-height: 600px;
            border: 1px solid #cbd5e1;
        }
        
        table {
            border-collapse: collapse;
            width: 100%;
        }
        
        th {
            background: #f1f5f9;
            color: #475569;
            font-weight: 600;
            text-align: center;
            padding: 10px;
            min-width: 120px;
            border: 1px solid #cbd5e1;
            position: sticky;
            top: 0;
            z-index: 10;
        }
        
        td {
            padding: 0;
            border: 1px solid #cbd5e1;
            height: 40px;
            min-width: 120px;
        }
        
        .cell {
            width: 100%;
            height: 100%;
            padding: 8px;
            border: none;
            outline: none;
            font-size: 14px;
            background: transparent;
        }
        
        .cell:focus {
            background: #dbeafe;
        }
        
        .selected {
            background: #dbeafe !important;
            outline: 2px solid #3b82f6;
        }
        
        .header-cell {
            background: #f8fafc;
            color: #64748b;
            font-weight: bold;
            text-align: center;
            border: 1px solid #cbd5e1;
        }
        
        .status-bar {
            background: #f1f5f9;
            padding: 10px 15px;
            border-top: 1px solid #e2e8f0;
            color: #64748b;
            font-size: 14px;
        }
        
        .row-header {
            position: sticky;
            left: 0;
            background: #f8fafc;
            z-index: 5;
        }
        
        .col-header {
            position: sticky;
            top: 0;
            z-index: 5;
        }
        
        @media (max-width: 768px) {
            .spreadsheet-container {
                border-radius: 0;
            }
            
            .toolbar {
                flex-direction: column;
            }
            
            .toolbar button {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="spreadsheet-container">
        <div class="toolbar">
            <button onclick="addRow()">+ Satır Ekle</button>
            <button onclick="addColumn()">+ Sütun Ekle</button>
            <button onclick="clearSelected()">Temizle</button>
            <button onclick="exportToCSV()">CSV Olarak İndir</button>
            <button onclick="sumSelected()">Toplam Hesapla</button>
            <button onclick="calculateAverage()">Ortalama Hesapla</button>
        </div>
        
        <div class="formula-bar">
            <label for="formula">Formül:</label>
            <input type="text" id="formula" placeholder="Hücre değerini veya formülünü girin...">
        </div>
        
        <div class="spreadsheet">
            <table id="spreadsheet-table">
                <thead id="table-header"></thead>
                <tbody id="table-body"></tbody>
            </table>
        </div>
        
        <div class="status-bar">
            <span id="status">Hazır</span>
        </div>
    </div>

    <script>
        let selectedCell = null;
        let rows = 10;
        let cols = 8;
        
        // Başlangıçta tabloyu oluştur
        document.addEventListener('DOMContentLoaded', function() {
            createSpreadsheet();
            updateStatus('Tablo oluşturuldu. Bir hücre seçin.');
        });
        
        function createSpreadsheet() {
            createHeaders();
            createRows();
        }
        
        function createHeaders() {
            const header = document.getElementById('table-header');
            header.innerHTML = '';
            
            let headerRow = '<tr><th class="row-header header-cell">#</th>';
            
            for (let col = 0; col < cols; col++) {
                const colLetter = getColumnLetter(col);
                headerRow += `<th class="col-header header-cell">${colLetter}</th>`;
            }
            
            headerRow += '</tr>';
            header.innerHTML = headerRow;
        }
        
        function createRows() {
            const tbody = document.getElementById('table-body');
            tbody.innerHTML = '';
            
            for (let row = 0; row < rows; row++) {
                const tr = document.createElement('tr');
                
                // Satır numarası
                const rowHeader = document.createElement('td');
                rowHeader.className = 'row-header header-cell';
                rowHeader.textContent = row + 1;
                tr.appendChild(rowHeader);
                
                // Hücreler
                for (let col = 0; col < cols; col++) {
                    const td = document.createElement('td');
                    const cellId = `${getColumnLetter(col)}${row + 1}`;
                    
                    const input = document.createElement('input');
                    input.type = 'text';
                    input.className = 'cell';
                    input.id = cellId;
                    input.dataset.row = row;
                    input.dataset.col = col;
                    input.placeholder = '';
                    
                    input.addEventListener('focus', function() {
                        selectCell(this);
                    });
                    
                    input.addEventListener('input', function() {
                        updateCellValue(this);
                    });
                    
                    td.appendChild(input);
                    tr.appendChild(td);
                }
                
                tbody.appendChild(tr);
            }
        }
        
        function selectCell(cell) {
            if (selectedCell) {
                selectedCell.classList.remove('selected');
            }
            
            selectedCell = cell;
            cell.classList.add('selected');
            
            const formulaInput = document.getElementById('formula');
            formulaInput.value = cell.value;
            
            updateStatus(`${cell.id} hücresi seçildi. Değer: ${cell.value || '(boş)'}`);
        }
        
        function updateCellValue(cell) {
            const formulaInput = document.getElementById('formula');
            formulaInput.value = cell.value;
            
            // Basit formül kontrolü
            if (cell.value.startsWith('=')) {
                try {
                    const result = evaluateFormula(cell.value.substring(1));
                    cell.value = result;
                } catch (error) {
                    cell.value = '#HATA!';
                }
            }
        }
        
        function evaluateFormula(formula) {
            // Basit toplama formülü örneği: =SUM(A1:B2)
            if (formula.toUpperCase().startsWith('SUM(')) {
                const range = formula.substring(4, formula.length - 1);
                return calculateRangeSum(range);
            }
            
            // Basit aritmetik işlemler
            return eval(formula.replace(/[A-Z]+\d+/g, (match) => {
                const cell = document.getElementById(match);
                return cell ? parseFloat(cell.value) || 0 : 0;
            }));
        }
        
        function calculateRangeSum(range) {
            const [start, end] = range.split(':');
            let sum = 0;
            
            const startCol = start.match(/[A-Z]+/)[0];
            const startRow = parseInt(start.match(/\d+/)[0]);
            const endCol = end.match(/[A-Z]+/)[0];
            const endRow = parseInt(end.match(/\d+/)[0]);
            
            for (let row = startRow; row <= endRow; row++) {
                for (let col = getColumnIndex(startCol); col <= getColumnIndex(endCol); col++) {
                    const cellId = `${getColumnLetter(col)}${row}`;
                    const cell = document.getElementById(cellId);
                    if (cell) {
                        sum += parseFloat(cell.value) || 0;
                    }
                }
            }
            
            return sum;
        }
        
        function addRow() {
            rows++;
            createSpreadsheet();
            updateStatus(`${rows}. satır eklendi.`);
        }
        
        function addColumn() {
            cols++;
            createSpreadsheet();
            updateStatus(`${getColumnLetter(cols - 1)} sütunu eklendi.`);
        }
        
        function clearSelected() {
            if (selectedCell) {
                selectedCell.value = '';
                updateStatus(`${selectedCell.id} hücresi temizlendi.`);
            } else {
                updateStatus('Lütfen önce bir hücre seçin.');
            }
        }
        
        function sumSelected() {
            if (selectedCell) {
                const row = parseInt(selectedCell.dataset.row);
                const col = parseInt(selectedCell.dataset.col);
                let sum = 0;
                
                for (let r = 0; r < rows; r++) {
                    const cellId = `${getColumnLetter(col)}${r + 1}`;
                    const cell = document.getElementById(cellId);
                    if (cell) {
                        sum += parseFloat(cell.value) || 0;
                    }
                }
                
                selectedCell.value = sum;
                updateStatus(`${getColumnLetter(col)} sütununun toplamı: ${sum}`);
            }
        }
        
        function calculateAverage() {
            if (selectedCell) {
                const row = parseInt(selectedCell.dataset.row);
                const col = parseInt(selectedCell.dataset.col);
                let sum = 0;
                let count = 0;
                
                for (let r = 0; r < rows; r++) {
                    const cellId = `${getColumnLetter(col)}${r + 1}`;
                    const cell = document.getElementById(cellId);
                    if (cell && cell.value !== '') {
                        sum += parseFloat(cell.value) || 0;
                        count++;
                    }
                }
                
                const average = count > 0 ? (sum / count).toFixed(2) : 0;
                selectedCell.value = average;
                updateStatus(`${getColumnLetter(col)} sütununun ortalaması: ${average}`);
            }
        }
        
        function exportToCSV() {
            let csv = '';
            
            // Başlıklar
            csv += ',"';
            for (let col = 0; col < cols; col++) {
                csv += getColumnLetter(col) + (col < cols - 1 ? '","' : '"');
            }
            csv += '\n';
            
            // Veriler
            for (let row = 0; row < rows; row++) {
                csv += (row + 1) + ',"';
                
                for (let col = 0; col < cols; col++) {
                    const cellId = `${getColumnLetter(col)}${row + 1}`;
                    const cell = document.getElementById(cellId);
                    csv += (cell ? cell.value.replace(/"/g, '""') : '') + (col < cols - 1 ? '","' : '"');
                }
                
                csv += '\n';
            }
            
            const blob = new Blob([csv], { type: 'text/csv' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'tablo.csv';
            a.click();
            
            updateStatus('CSV dosyası indirildi.');
        }
        
        function getColumnLetter(index) {
            let letter = '';
            while (index >= 0) {
                letter = String.fromCharCode(65 + (index % 26)) + letter;
                index = Math.floor(index / 26) - 1;
            }
            return letter || 'A';
        }
        
        function getColumnIndex(letter) {
            let index = 0;
            for (let i = 0; i < letter.length; i++) {
                index = index * 26 + letter.charCodeAt(i) - 64;
            }
            return index - 1;
        }
        
        function updateStatus(message) {
            document.getElementById('status').textContent = message;
        }
    </script>
</body>
</html>